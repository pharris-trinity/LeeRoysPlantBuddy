<!-- views/checkout.ejs -->
<%- include('partials/head', { title: 'Developers' }) %>

<div class="index-container2">
    <span>
        <div class="landing-title">Developers</div>
        <div class="landing-text">Developers</div>
    </span>
</div>

<!--
<script>
    function removeFromCart(id) {
        fetch('/removeFromCart', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ id }),
        })
        .then(response => {
            if(!response.ok) {
                throw new Error(`HTTP Error! Status: ${response.status}`)
            }
        })
    }

    function addQuantity(id) {
        fetch('/addtoCart', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ id }),
        })
        .then(response => {
            if(!response.ok) {
                throw new Error(`HTTP Error! Status: ${response.status}`)
            }
        })
    }

    function emptyCart(cart) {
        fetch('/emptyCart', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ cart }),
        })
        .then(response => {
            console.log(response);
            if(!response.ok) {
                throw new Error(`HTTP Error! Status: ${response.status}`)
            }
        })
    }

    window.onload = function() {
        var cookieValue = document.cookie;
        console.log(cookieValue);
    }
</script>

<div class="row">
    <div class="column left" style="height: 350px; width: 25%;">
        <h2>Shopping Cart</h2>
        <div class="container">
            <table class="Cart">
                <% cart.forEach((product, productindx) => { %>
                <tr>
                    <td><span><button class="add-quantity" onclick="addQuantity('<%=product.product_id%>'); window.location.reload();"></button> <%=product.quantity%></span></td>                                
                    <td><span><%=product.product_name%></span></td>
                    <td><span>$ <%=+(Math.round((product.product_price * product.quantity) + "e+2") + "e-2")%></span></td>
                    <td><span><button class="remove-from-cart" onclick="removeFromCart('<%=product.product_id%>');window.location.reload();"></button></span></td>
                </tr>
                <% }); %>
            </table>
        </div>
    </div>

    <div class="column right" style="height: 350px; width: 25%;">
        <h2>Order Summary</h2>
        <div class="container">
            <div class="row">
                <div class="column left" style="height: 75px; width: 50px; background-color: transparent; margin-top: 0; text-align: left;">
                    <p> Subtotal:</p>
                    <p> Tax:</p>
                    <p> Shipping:</p>
                </div>
                <div class="column right" style="height: 75px; width: 50px; background-color: transparent;margin-top: 0;text-align: left;">
                    <%let subtotal = 0%>
                    <%cart.forEach((id) => {subtotal += (id.product_price * id.quantity); });%>
                    <p><span> $<%=+(Math.round(subtotal + "e+2") + "e-2")%> </span></p>
                    <%let tax = +(Math.round((subtotal * 0.0625) + "e+2") + "e-2")%>
                    <p><span>$<%=tax%></span></p>
                    <%let shipping = +(Math.round((subtotal * 0.15) + "e+2") + "e-2")%>
                    <p><span>$<%=shipping%></span></p>
                </div>
            </div>
        </div>
        <br> <br>
        <%let total = subtotal + tax + shipping%>
        <h4> Total: <span>$<%=+(Math.round((total) + "e+2") + "e-2")%></span></h4>
        <br>
        <button class="button" style="display: inline-block" onclick="emptyCart('<%=cart%>');window.location.reload(); ">Buy Now</button>
    </div>
</div>
-->